#!/usr/bin/env bash
limit=$((95*1024*1024))
git diff --cached --name-only | while read f; do
  [ -f "$f" ] || continue
  s=$(wc -c <"$f")
  if [ "$s" -gt "$limit" ]; then
    echo "Abort: $f is $(numfmt --to=iec "$s"), exceeds 95MB"
    exit 1
  fi
done
